#!/usr/bin/env ruby
# -*- encoding: utf-8 -*-

#$LOAD_PATH

# begin
require 'gherkify'
# rescue LoadError
#   lib = File.expand_path('../../lib', __FILE__)
#   $LOAD_PATH.unshift(lib) unless $LOAD_PATH.include?(lib)
#   require 'gherkify'
# end

require 'slop'
require 'awesome_print'

def main
  opts = Slop.parse(help: true) do
    banner 'Usage: gherkify path [options]'
    on 'd', 'dir', 'Output directory', argument: :optional
  end

  path = ARGV[0]
  puts opts.help and return if path.nil?
  puts "#{path} -> #{opts[:dir]}" if opts.dir?

  if File.directory? path
    files = Dir.glob(File.join(path, "*.feature"))
  else
    files = [path]
  end

  features = Gherkify.parse_files(files)

  features.each { |e| puts e.to_s }
    

end





# url: http://yuml.me/diagram/scruffy;scale:80;/class/
# params: dsl_text = [Customer]->[Billing Address]

main